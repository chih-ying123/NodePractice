<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <script src="js/jquery.min.js"></script>
</head>

<body>
    <form action="/user/add" method="POST" id="addUserForm">
        <h4>新增資料</h4>
        暱稱: <input type="text" name="UserName" id="UserName" required="required">
        <br>帳號: <input type="text" name="UserAccount" id="UserAccount" required="required">
        <br>信箱: <input type="email" name="Email" id="Email" required="required">
        <br>密碼: <input type="password" name="UserPassword" id="UserPassword" required="required">
        <br>備註: <input type="text" name="Memo" id="Memo" required="required">
        <br><button type="submit">確定新增</button>

    </form>

    <script>
        // 改成fetch， 不要讓頁面刷新

        let addUserForm = document.getElementById('addUserForm');
	    addUserForm.addEventListener('submit',(e)=>{

		e.preventDefault(); //不讓表單提交 step1 (自行搜尋功能 preventDefault())

		let action = addUserForm.action;
		let postPostBody = $('#addUserForm').serialize() //jQuery用法ajax serialize()序列化表單值  key1=value1&key2=value2

		let postOptions = {
			method: 'POST',
			body: postPostBody,
			headers: new Headers({
				'Content-Type': 'application/x-www-form-urlencoded'
			})
		}

		fetch(action, postOptions).then(res => res.json()).then(res=>{
			alert(res.resultMessage);
		});

		return false; //不讓表單真的提交 step2


	});

    </script>
</body>

</html>